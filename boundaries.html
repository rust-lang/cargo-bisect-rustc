<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Bisection boundaries - cargo-bisect-rustc</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">cargo-bisect-rustc</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/cargo-bisect-rustc/tree/master/guide/src" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/cargo-bisect-rustc/edit/master/guide/src/boundaries.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bisection-boundaries"><a class="header" href="#bisection-boundaries">Bisection boundaries</a></h1>
<p><code>cargo-bisect-rustc</code> does a binary search for the regression using a <em>start</em> and <em>end</em> boundary.
You can specify these boundaries with the <code>--start</code> and <code>--end</code> CLI flags.
There are several ways to specify what those boundaries are.
If you run the command without specifying the boundaries, it will search for them automatically:</p>
<pre><code class="language-sh"># No --start or --end flags
cargo bisect-rustc
</code></pre>
<p>This will assume the latest nightly is a regression (the <em>end</em> boundary).
It will then search backwards until it can find a nightly that passes to use as the <em>start</em> boundary.
Bisection can usually go faster if you happen to know the start boundary, so that it doesn’t need to search for it.</p>
<p><code>--start</code> and <code>--end</code> are optional.
If <code>--start</code> is not specified, then it will try to find the start range automatically.
If <code>--end</code> is not specified, it will assume it is the most recently available.</p>
<h2 id="date-boundaries"><a class="header" href="#date-boundaries">Date boundaries</a></h2>
<p>You can pass a date in the form YYYY-MM-DD to the <code>--start</code> and <code>--end</code> flags.
It will download the nightly corresponding to that date, and then begin bisecting those nightlies.</p>
<pre><code class="language-sh">cargo bisect-rustc --start=2018-08-14 --end=2018-10-11
</code></pre>
<p>If the nightly with the regression was within the past 167 days, then it will automatically start bisecting the individual PRs merged on that day using <a href="#git-commit-boundaries">Git commit boundaries</a>.</p>
<blockquote>
<p><strong>Note</strong>: A pitfall is that if you use something like <code>rustc +nightly --version</code> to figure out the version you are on it will often identify a date that is one day early from the nightly toolchain version. E.g. <code>nightly-2025-07-19</code> will say <code>2025-07-18</code>, since that is when the most recent commit was merged, even though the toolchain was published on the 19th.</p>
</blockquote>
<h2 id="git-commit-boundaries"><a class="header" href="#git-commit-boundaries">Git commit boundaries</a></h2>
<p>You can pass the particular git commit hash of a PR as a boundary.
The Rust project keeps the builds of every merged PR for the last 167 days.
If you happen to know the PR to use as a boundary, you can pass the SHA-1 hash of that PR.</p>
<pre><code class="language-sh">cargo bisect-rustc \
    --start=6323d9a45bdf0ac2a9319a6a558537e0a7e6abd1 \
    --end=866a713258915e6cbb212d135f751a6a8c9e1c0a
</code></pre>
<p>There are several ways to determine the SHA-1 hash for a PR.</p>
<ul>
<li>On the PR itself, you should see a message like “bors merged commit c50c62d into <code>rust-lang:&lt;default-branch&gt;</code>”.
You can copy that hash to use as a boundary.
If the PR was merged as part of a rollup, you will need to use the hash of the rollup instead.
You’ll need to look through the PR messages to see if the PR was mentioned from a rollup PR.</li>
<li>In the rust repo, run <code>git log --first-parent upstream/HEAD</code> (where <code>upstream</code> is your origin name for <code>rust-lang/rust</code>).
This will show all the top-level commits.
You can then search for your PR.</li>
</ul>
<blockquote>
<p><strong>Note</strong>: If the PR was merged after the most recent nightly, you’ll need to be sure to also specify the <code>--end</code> range.
Otherwise it will assume the most recent nightly is the <em>end</em> and it won’t work if the start is after the end.</p>
</blockquote>
<p>If the regression is found in a <a href="https://forge.rust-lang.org/release/rollups.html">rollup PR</a>, then <code>cargo-bisect-rustc</code> will bisect the individual PRs within the rollup.
This final bisection is only available for <code>x86_64-unknown-linux-gnu</code> since it is using the builds made for the <a href="https://perf.rust-lang.org/">rustc performance tracker</a>.</p>
<blockquote>
<p><strong>Note</strong>: If you specify date boundaries, then you can use the <code>--by-commit</code> CLI option to force it to use PR commits instead of nightlies.</p>
</blockquote>
<h2 id="git-tag-boundaries"><a class="header" href="#git-tag-boundaries">Git tag boundaries</a></h2>
<p>The boundary can be specified with a git release tag.
This is useful if you know something works in one release and not another, but you don’t happen to know which nightly this corresponds with.
When given a tag, <code>cargo-bisect-rustc</code> will try to find the nightly that corresponds with that release.
For example:</p>
<pre><code class="language-sh">cargo bisect-rustc --start=1.58.0 --end=1.59.0
</code></pre>
<h2 id="monotonicity"><a class="header" href="#monotonicity">Monotonicity</a></h2>
<p>When writing your test and picking a bisection range, you should be careful to ensure that the test won’t vary between pass/fail over the bisection range.
It should only transition from good to bad once in the bisection range (it must change
<a href="https://en.wikipedia.org/wiki/Bisection_(software_engineering)#Monotonicity">monotonically</a>).</p>
<p>In the following example, <code>cargo-bisect-rustc</code> will find one of the transitions, but that may not be the true root cause of the issue you are investigating.</p>
<pre><code class="language-text">nightly-2023-02-01 baseline **start**
nightly-2023-02-02 baseline
nightly-2023-02-03 baseline
nightly-2023-02-04 regression
nightly-2023-02-05 regression
nightly-2023-02-06 baseline
nightly-2023-02-07 regression
nightly-2023-02-08 regression **end**
</code></pre>
<p>Here it may either find 2023-02-04 or 2023-02-07 as the regression.</p>
<p>The following are some suggestions for avoiding or dealing with this problem:</p>
<ul>
<li>Make sure your test reliably exhibits the issue you are looking for, and does not generate any false positives or false negatives.</li>
<li>Analyze the PR that was reported as the regression.
Do the changes in the PR seem to be a probable cause?</li>
<li>Try to keep the bisection range small to reduce the probability that you will encounter multiple regression transitions.</li>
<li>Use the <code>-vv</code> flag (very verbose) to display the output from the compiler to make sure it is what you expect.</li>
<li>Use the <a href="tutorial.html#testing-interactively"><code>--prompt</code></a> flag to inspect the output and verify each step.</li>
<li>Beware that some issues may get fixed and then regress multiple times.
Try to keep the bisection range as close to the present day as possible.
Compare the output of the “regressed” commit to the latest nightly to see if they are the same.</li>
<li>If the test only fails sporadically, use a <a href="examples/flaky.html">script</a> to run the compiler many times until it fails or it passes enough iterations that you feel confident that it is good.</li>
<li>If the code requires relatively new language features, be careful not to pick a starting range that is too old.</li>
<li>Beware of code-generation bugs that can be sensitive to code layout.
Since the code to rustc changes rapidly over time, code can shift around causing different layouts and optimizations, which might cause an issue to appear and disappear several times over the bisection range.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="rust-src-repo.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="rustup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="rust-src-repo.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="rustup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
